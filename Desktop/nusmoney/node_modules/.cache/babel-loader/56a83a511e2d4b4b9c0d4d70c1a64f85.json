{"ast":null,"code":"var _jsxFileName = \"/Users/shaohualoo/Desktop/Fintech PC2 DevKit1 Code/Toolkit2/nusmoney project v2/src/App.js\";\n\n/* Demo for FinTech@SG Course \nGeneration of Charts Based on JSON data from Server\nAuthor: Prof Bhojan Anand */\n//Install d3.js:   npm install d3 --save\nimport React from \"react\";\nimport logo from \"./finallogo.jpeg\";\nimport * as d3 from 'd3';\nimport \"./App.css\";\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      accountsData: [],\n      usersData: [],\n      transactionsData: []\n    };\n  }\n\n  callAPIServerAccounts() {\n    // when button clicked, start a GET request\n    // to specified URL\n    fetch(\"http://localhost:8000/account/all\").then(res => res.text()).then(res => this.setState({\n      accountsData: JSON.parse(res)\n    })).catch(err => err);\n  }\n\n  callAPIServerUsers() {\n    // when button clicked, start a GET request\n    // to specified URL\n    fetch(\"http://localhost:8000/user/all\").then(response => response.json()).then(usersData => this.setState({\n      usersData\n    })).catch(err => err);\n  }\n\n  callAPIServerTransactions() {\n    // when button clicked, start a GET request\n    // to specified URL\n    fetch(\"http://localhost:8000/transaction/all\").then(res => res.text()).then(res => this.setState({\n      transactionsData: JSON.parse(res)\n    })).catch(err => err);\n  }\n\n  accountsButton() {\n    this.callAPIServerAccounts();\n  }\n\n  usersButton() {\n    this.callAPIServerUsers();\n  }\n\n  transactionsButton() {\n    this.callAPIServerTransactions();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    //when data received run this\n\n    /* prepare data */\n    this.state.accountsData.forEach(function (d) {\n      d.balance = d.balance.replace(/[^0-9.-]+/g, \"\"); //regular expression to convert currency to Numeric form\n    }); // this.showChartAccounts();  //improved version way to chart\n\n    this.state.transactionsData.forEach(function (d) {\n      d.amount = d.amount.replace(/[^0-9.]+/g, \"\"); //regular expression to convert currency to Numeric form\n    }); // this.showChartTransactions();\n  }\n\n  showChartAccounts() {\n    const margin = {\n      top: 50,\n      right: 50,\n      bottom: 50,\n      left: 50\n    };\n    var width = 1000 - margin.left - margin.right;\n    var height = 500 - margin.top - margin.bottom;\n    var svg = d3.select(\"#barChart\").attr(\"width\", width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom).append(\"g\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n    svg.selectAll(\"*\").remove();\n    var x = d3.scaleBand().range([0, width]);\n    var y = d3.scaleLinear().range([height, 0]);\n    x.domain(this.state.accountsData.map(details => details.account_id));\n    y.domain([0, 2200]);\n    svg.selectAll(\".bar\").data(this.state.accountsData).enter().append(\"rect\").attr(\"class\", \"bar\").attr(\"x\", d => x(d.account_id)).attr(\"width\", x.bandwidth() - 10).attr(\"y\", d => y(d.balance)).attr(\"height\", d => height - y(d.balance));\n    svg.append(\"g\").attr(\"transform\", \"translate(0,\" + height + \")\").call(d3.axisBottom(x));\n    svg.append(\"g\").call(d3.axisLeft(y));\n  }\n\n  showChartTransactions() {\n    this.state.transactionsData.forEach(function (obj) {\n      obj.amount = parseInt(obj.amount);\n    });\n    var transactionsDataSummed = this.state.transactionsData.reduce((accumulator, cur) => {\n      let accound_id = cur.account_id;\n      let found = accumulator.find(elem => elem.account_id === account_id);\n      if (found) found.amount += cur.amount;else accumulator.push(cur);\n      return accumulator;\n    }, []);\n    const margin = {\n      top: 50,\n      right: 50,\n      bottom: 50,\n      left: 50\n    };\n    var width = 1000 - margin.left - margin.right;\n    var height = 500 - margin.top - margin.bottom;\n    var svg = d3.select(\"#barChart2\").attr(\"width\", width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom).append(\"g\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n    svg.selectAll(\"*\").remove();\n    var x = d3.scaleBand().range([0, width]);\n    var y = d3.scaleLinear().range([height, 0]);\n    x.domain(transactionsDataSummed.map(details => details.account_id));\n    y.domain([0, 8000]);\n    svg.selectAll(\".bar\").data(transactionsDataSummed).enter().append(\"rect\").attr(\"class\", \"bar\").attr(\"x\", d => x(d.account_id)).attr(\"width\", x.bandwidth() - 10).attr(\"y\", d => y(d.amount)).attr(\"height\", d => height - y(d.amount));\n    svg.append(\"g\").attr(\"transform\", \"translate(0,\" + height + \")\").call(d3.axisBottom(x));\n    svg.append(\"g\").call(d3.axisLeft(y));\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"header\", {\n      className: \"App-header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: logo,\n      className: \"App-logo\",\n      alt: \"logo\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"h1\", {\n      className: \"App-title\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 11\n      }\n    }, \"NUSmoney App by Anuflora Bank\"), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      className: \".btn\",\n      onClick: () => this.accountsButton(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 11\n      }\n    }, \"Get Accounts Data\"), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      className: \".btn\",\n      onClick: () => this.usersButton(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 11\n      }\n    }, \"Get Users Data\"), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      className: \".btn\",\n      onClick: () => this.transactionsButton(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 11\n      }\n    }, \"Get Transactions Data\")), /*#__PURE__*/React.createElement(\"table\", {\n      className: \"myTable\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 11\n      }\n    }, this.state.accountsData.map(item => {\n      return /*#__PURE__*/React.createElement(\"tr\", {\n        key: item.account_id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 17\n        }\n      }, \" \", item.user_id, \" \"), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221,\n          columnNumber: 17\n        }\n      }, \" \", item.account_type, \" \"), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 17\n        }\n      }, \" \", item.balance, \" \"), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 17\n        }\n      }, \" \", item.max_limit, \" \"), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 17\n        }\n      }, \" \", item.date_created, \" \"));\n    }))), /*#__PURE__*/React.createElement(\"table\", {\n      className: \"myTable\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 17\n      }\n    }, this.state.usersData.map(item => {\n      return /*#__PURE__*/React.createElement(\"tr\", {\n        key: item.user_id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 29\n        }\n      }, \" \", item.user_name, \" \"), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 29\n        }\n      }, \" \", item.email, \" \"), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 29\n        }\n      }, \" \", item.mobilenumber, \"  \"), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 29\n        }\n      }, \" \", item.password, \" \"), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 29\n        }\n      }, \" \", item.ic_number, \" \"));\n    }))), /*#__PURE__*/React.createElement(\"table\", {\n      className: \"myTable\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 17\n      }\n    }, this.state.transactionsData.map(item => {\n      return /*#__PURE__*/React.createElement(\"tr\", {\n        key: item.transaction_id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 29\n        }\n      }, \" \", item.account_id, \" \"), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 29\n        }\n      }, \" \", item.date, \" \"), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 254,\n          columnNumber: 29\n        }\n      }, \" \", item.amount, \"  \"), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 29\n        }\n      }, \" \", item.comments, \" \"));\n    }))), /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 9\n      }\n    }, \" Visualisation of Data\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \".btn\",\n      onClick: () => this.showChartAccounts(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 10\n      }\n    }, \"click\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \".btn\",\n      onClick: () => this.showChartTransactions(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 11\n      }\n    }, \"click\"), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"svg\", {\n      id: \"barChart\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 282,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"svg\", {\n      id: \"barChart2\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 283,\n        columnNumber: 13\n      }\n    }))));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/shaohualoo/Desktop/Fintech PC2 DevKit1 Code/Toolkit2/nusmoney project v2/src/App.js"],"names":["React","logo","d3","App","Component","constructor","props","state","accountsData","usersData","transactionsData","callAPIServerAccounts","fetch","then","res","text","setState","JSON","parse","catch","err","callAPIServerUsers","response","json","callAPIServerTransactions","accountsButton","usersButton","transactionsButton","componentDidUpdate","prevProps","prevState","forEach","d","balance","replace","amount","showChartAccounts","margin","top","right","bottom","left","width","height","svg","select","attr","append","selectAll","remove","x","scaleBand","range","y","scaleLinear","domain","map","details","account_id","data","enter","bandwidth","call","axisBottom","axisLeft","showChartTransactions","obj","parseInt","transactionsDataSummed","reduce","accumulator","cur","accound_id","found","find","elem","push","render","item","user_id","account_type","max_limit","date_created","user_name","email","mobilenumber","password","ic_number","transaction_id","date","comments"],"mappings":"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","sourcesContent":["/* Demo for FinTech@SG Course \nGeneration of Charts Based on JSON data from Server\nAuthor: Prof Bhojan Anand */\n//Install d3.js:   npm install d3 --save\nimport React from \"react\";\nimport logo from \"./finallogo.jpeg\";\nimport * as d3 from 'd3' \n\nimport \"./App.css\";\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { \n      accountsData: [],\n      usersData: [],\n      transactionsData: []\n    };\n  }\n\n  \n\n  callAPIServerAccounts() {\n    // when button clicked, start a GET request\n    // to specified URL\n    fetch(\"http://localhost:8000/account/all\")\n      .then(res => res.text())\n      .then(res => this.setState({ accountsData: JSON.parse(res) }))\n      .catch(err => err);\n\n    }\n\n  callAPIServerUsers() {\n      // when button clicked, start a GET request\n      // to specified URL\n      fetch(\"http://localhost:8000/user/all\")\n       .then(response => response.json())\n       .then(usersData => this.setState({ usersData }))\n       .catch(err => err);\n  \n      }\n\n    callAPIServerTransactions() {\n        // when button clicked, start a GET request\n        // to specified URL\n        fetch(\"http://localhost:8000/transaction/all\")\n          .then(res => res.text())\n          .then(res => this.setState({ transactionsData: JSON.parse(res) }))\n          .catch(err => err);\n    \n        }\n  \n  accountsButton() {\n    this.callAPIServerAccounts();\n  }\n    \n\n  usersButton() {\n    this.callAPIServerUsers();\n  }\n\n  transactionsButton() {\n    this.callAPIServerTransactions();\n\n \n  }\n \n  componentDidUpdate(prevProps, prevState) {\n  //when data received run this\n    /* prepare data */\n  \n    this.state.accountsData.forEach(function (d) {\n      d.balance = d.balance.replace(/[^0-9.-]+/g,\"\");  //regular expression to convert currency to Numeric form\n     \n    });\n  \n    // this.showChartAccounts();  //improved version way to chart\n      \n  \n  \n  \n    this.state.transactionsData.forEach(function (d) {\n      d.amount = d.amount.replace(/[^0-9.]+/g,\"\");  //regular expression to convert currency to Numeric form\n    });\n   // this.showChartTransactions();\n\n  \n\n  }\n\n\n\n  showChartAccounts() {\n\n  \n    const margin = { top: 50, right: 50, bottom: 50, left: 50 };\n    var width = 1000 - margin.left - margin.right;\n    var height = 500 - margin.top - margin.bottom;\n    var svg = d3.select(\"#barChart\")\n      .attr(\"width\", width + margin.left + margin.right)\n      .attr(\"height\", height + margin.top + margin.bottom)\n      .append(\"g\")\n      .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\")\n    \n    svg.selectAll(\"*\").remove();\n  \n    var x = d3.scaleBand().range([0, width]);\n    var y = d3.scaleLinear().range([height, 0]);\n  \n    x.domain(this.state.accountsData.map(details => details.account_id));\n    y.domain([0, 2200]);\n  \n  \n  \n    svg.selectAll(\".bar\")\n      .data(this.state.accountsData)\n      .enter()\n      .append(\"rect\")\n      .attr(\"class\", \"bar\")\n      .attr(\"x\", d => x(d.account_id))\n      .attr(\"width\", x.bandwidth() - 10)\n      .attr(\"y\", d => y(d.balance))\n      .attr(\"height\", d => height - y(d.balance));\n  \n    svg.append(\"g\")\n      .attr(\"transform\", \"translate(0,\" + height + \")\")\n      .call(d3.axisBottom(x))\n  \n    svg.append(\"g\")\n      .call(d3.axisLeft(y));\n  }\n\n  showChartTransactions() {\n\n    this.state.transactionsData.forEach(function(obj) {\n      obj.amount = parseInt(obj.amount); \n    });\n    var transactionsDataSummed = this.state.transactionsData.reduce((accumulator, cur) => {\n      let accound_id = cur.account_id;\n      let found = accumulator.find(elem => elem.account_id === account_id)\n      if (found) found.amount += cur.amount;\n      else accumulator.push(cur);\n      return accumulator;\n    }, []);\n\n    const margin = { top: 50, right: 50, bottom: 50, left: 50 };\n    var width = 1000 - margin.left - margin.right;\n    var height = 500 - margin.top - margin.bottom;\n    var svg = d3.select(\"#barChart2\")\n      .attr(\"width\", width + margin.left + margin.right)\n      .attr(\"height\", height + margin.top + margin.bottom)\n      .append(\"g\")\n      .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\")\n    \n    svg.selectAll(\"*\").remove();\n  \n    var x = d3.scaleBand().range([0, width]);\n    var y = d3.scaleLinear().range([height, 0]);\n  \n    x.domain(transactionsDataSummed.map(details => details.account_id));\n    y.domain([0, 8000]);\n  \n  \n  \n    svg.selectAll(\".bar\")\n      .data(transactionsDataSummed)\n      .enter()\n      .append(\"rect\")\n      .attr(\"class\", \"bar\")\n      .attr(\"x\", d => x(d.account_id))\n      .attr(\"width\", x.bandwidth() - 10)\n      .attr(\"y\", d => y(d.amount))\n      .attr(\"height\", d => height - y(d.amount));\n  \n    svg.append(\"g\")\n      .attr(\"transform\", \"translate(0,\" + height + \")\")\n      .call(d3.axisBottom(x))\n  \n    svg.append(\"g\")\n      .call(d3.axisLeft(y));\n  }\n\n\n  render() {\n    return (\n      <div className=\"App\">\n        <header className=\"App-header\">\n          <img src={logo} className=\"App-logo\" alt=\"logo\" />\n          <h1 className=\"App-title\">NUSmoney App by Anuflora Bank</h1>\n          <br/>\n          <button\n            className=\".btn\"\n            onClick={() => this.accountsButton()}\n          >\n            Get Accounts Data\n          </button>\n          <br/>\n          <button\n            className=\".btn\"\n            onClick={() => this.usersButton()}\n          >\n            Get Users Data\n          </button>\n          <br/>\n          <button\n            className=\".btn\"\n            onClick={() => this.transactionsButton()}\n          >\n            Get Transactions Data\n          </button>\n\n        </header>\n\n        \n        <table className=\"myTable\">\n          <tbody>\n          {this.state.accountsData.map((item) => {\n            return (\n              <tr key={item.account_id}>\n                <td> {item.user_id} </td>\n                <td> {item.account_type} </td>\n                <td> {item.balance} </td>\n                <td> {item.max_limit} </td>\n                <td> {item.date_created} </td>\n              </tr>\n            );\n          })}\n          </tbody>\n        </table>\n\n        <table className=\"myTable\">\n                <tbody>\n                    {(this.state.usersData).map( (item) => {\n                    return (\n                      <tr key={item.user_id}>         \n                            <td> {item.user_name} </td>\n                            <td> {item.email} </td>\n                            <td> {item.mobilenumber}  </td>\n                            <td> {item.password} </td>\n                            <td> {item.ic_number} </td>\n                      </tr>\n                      )}\n                    )}\n                    </tbody>\n                </table>\n\n                <table className=\"myTable\">\n                <tbody>\n                    {(this.state.transactionsData).map( (item) => {\n                    return (\n                      <tr key={item.transaction_id}>         \n                            <td> {item.account_id} </td>\n                            <td> {item.date} </td>\n                            <td> {item.amount}  </td>\n                            <td> {item.comments} </td>\n                      </tr>\n                      )}\n                    )}\n                    </tbody>\n                </table>\n        \n\n        <h2> Visualisation of Data</h2>\n         \n         <button\n            className=\".btn\"\n            onClick={() => this.showChartAccounts()}\n          > \n         click\n          </button>\n\n          <button\n            className=\".btn\"\n            onClick={() => this.showChartTransactions()}\n          > \n         click\n          </button>\n\n          <div>\n            <svg id=\"barChart\"></svg>\n          \n            <div>\n            <svg id=\"barChart2\"></svg>\n          </div>\n      </div></div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}